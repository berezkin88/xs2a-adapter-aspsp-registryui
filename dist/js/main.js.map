{"version":3,"sources":["addEventListeners.js","globals.js","uneditableCells.js","toggleButtons.js","editableCells.js","searchButton.js","addRowButton.js","UUIDGenerator.js","greenButton.js","redButton.js","editButton.js","deleteButton.js","updateButton.js","saveButton.js","purgeRow.js","buildRow.js","showTable.js","clearTable.js","assembleRowData.js","upload.js","onEnterPress.js","clear.js","failureMessage.js","successMessage.js"],"names":[],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AChDA;AACA;AACA;AACA;AACA;AACA;AACA;ACNA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACjBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACbA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACZA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACnBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACvBA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC5EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACPA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AC3BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACpBA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;ACLA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;ACfA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"main.js","sourcesContent":["setTimeout(function () {\n    initGlobals();\n    document.querySelector(\"#add>button\").addEventListener(\"click\", addRow);\n    document.querySelector(\"#import>button\").addEventListener(\"click\", () => FILE_UPLOAD_FIELD.click());\n    FILE_UPLOAD_FIELD.addEventListener(\"change\", upload);\n    document.querySelectorAll(\".mdl-textfield__input\").forEach(field => field.addEventListener('keypress', event => onEnterPress(event)));\n}, 0)\n","function initGlobals() {\n    window.FILE_UPLOAD_FIELD = document.querySelector(\"#import-field\");\n    window.HIDDEN_ROW = document.querySelector(\"tbody>tr.hidden\");\n    window.COUNTER = 0;\n}\n","function uneditableCells(e) {\n    let rowCells = e.parentElement.parentElement.cells;\n    let approach = e.parentElement.parentElement.querySelectorAll('input');\n\n    for (let i = 1, till = (rowCells.length - 1); i < till; i++) {\n        rowCells[i].removeAttribute(\"contenteditable\");\n    }\n\n    approach.forEach(element => {\n        element.disabled = true;\n    })\n}\n","function toggleButtons(e) {\n    let editButton = e.parentNode.children[0];\n    let updateOrSaveButton = e.parentNode.children[1];\n    let deleteButton = e.parentNode.children[2];\n\n    if (editButton.style.display === \"none\") {\n        editButton.style.display = \"inherit\";\n        updateOrSaveButton.style.display = \"none\";\n        deleteButton.style.display = \"none\";\n        uneditableCells(e);\n    } else {\n        editButton.style.display = \"none\";\n        updateOrSaveButton.style.display = \"inherit\";\n        deleteButton.style.display = \"inherit\";\n        editableCells(e);\n    }\n}\n","function editableCells(e) {\n    let rowCells = e.parentElement.parentElement.cells;\n    let approach = e.parentElement.parentElement.querySelectorAll('input');\n\n    for (let i = 1, till = (rowCells.length - 2); i < till; i++) {\n        rowCells[i].setAttribute(\"contenteditable\", true);\n\n    }\n\n    approach.forEach(element => {\n        element.disabled = false;\n    })\n}\n","function search() {\n    clearTable();\n\n    let data = document.querySelector(\".search-form\");\n    let url = \"/v1/aspsps/?\";\n\n    if (data[0].value !== \"\")\n        url += \"name=\" + data[0].value.toLowerCase() + \"&\";\n\n    if (data[1].value !== \"\")\n        url += \"bic=\" + data[1].value + \"&\";\n\n    if (data[2].value !== \"\")\n        url += \"bankCode=\" + data[2].value + \"&\";\n\n    //  no need for now\n    // if (data[3].value !== \"\")\n    //     url += \"approache=\" + data[3].value.toLowerCase();\n\n    fetch(url)\n        .then((response) => {\n            if (!response.ok) {\n                searchFailed();\n                throw Error(response.statusText);\n            }\n            return response;\n        })\n        .then(response => response.text())\n        .then(response => JSON.parse(response).forEach((node) => buildRow(node)))\n        .catch(error => console.log(error));\n\n    if (HIDDEN_ROW.parentElement.parentElement.parentElement.hidden) {\n        showTable();\n    }\n}\n","function addRow() {\n    let editId = \"edit-\";\n    let updateId = \"update-\";\n    let deleteId = \"delete-\";\n\n    let clone = HIDDEN_ROW.cloneNode(true);\n    clone.cells[0].textContent = uuid();\n    clone.removeAttribute(\"class\");\n    clone.setAttribute(\"class\", \"new\");\n    clone.lastElementChild.childNodes.forEach(e => {\n        if (e.className) {\n            if (e.className.indexOf(\"edit\") > -1) {\n                let helper = e.parentNode.childNodes[7];\n    \n                e.addEventListener(\"click\", () => { editButton(e) })\n                e.setAttribute(\"id\", editId + COUNTER);\n    \n                helper.setAttribute(\"data-mdl-for\", editId + COUNTER);\n                editButton(e);\n            }\n    \n            if (e.className.indexOf(\"update\") > -1) {\n                let helper = e.parentNode.childNodes[9];\n    \n                e.addEventListener(\"click\", () => { greenButton(e) })\n                e.setAttribute(\"id\", updateId + COUNTER);\n    \n                helper.setAttribute(\"data-mdl-for\", updateId + COUNTER);\n            }\n    \n            if (e.className.indexOf(\"delete\") > -1) {\n                let helper = e.parentNode.childNodes[11];\n    \n                e.addEventListener(\"click\", () => { redButton(e) })\n                e.setAttribute(\"id\", deleteId + COUNTER);\n    \n                helper.setAttribute(\"data-mdl-for\", deleteId + COUNTER);\n            }\n        }\n    });\n    document.querySelector(\"table>tbody\").appendChild(clone)\n\n    COUNTER++;\n\n    if (HIDDEN_ROW.parentElement.parentElement.parentElement.hidden) {\n        showTable();\n    }\n}\n","function uuid() {\n    return 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {\n      var r = Math.random() * 16 | 0, v = c == 'x' ? r : (r & 0x3 | 0x8);\n      return v.toString(16);\n    });\n  }\n","function greenButton(e) {\n    let tableRow = e.parentElement.parentElement;\n\n    if (tableRow.className) {\n        if (window.confirm(\"Are you sure an aspsp has been built right?\")) {\n            saveButton(e);\n        } else {\n            return;\n        }\n    } else {\n        if (window.confirm(\"Are you sure you want to update the aspsp?\")) {\n            updateButton(e);\n        } else {\n            toggleButtons(e);\n        }\n    }\n}\n","function redButton(e) {\n    let tableRow = e.parentElement.parentElement;\n\n    if (tableRow.className) {\n        purgeRow(e);\n    } else {\n        if (window.confirm(\"You you sure you want to delete this aspsp record?\")) {\n            deleteButton(e);\n        } else {\n            toggleButtons(e);\n        }\n    }\n}\n","function editButton(e) {\n    let editButton = e.parentNode.children[0];\n    let updateOrSaveButton = e.parentNode.children[1];\n    let deleteButton = e.parentNode.children[2];\n\n    if (editButton.style.display !== \"none\") {\n        editButton.style.display = \"none\";\n        updateOrSaveButton.style.display = \"inherit\";\n        deleteButton.style.display = \"inherit\";\n        editableCells(e);\n    }\n}\n","function deleteButton(e) {\n    let uuidCell = e.parentElement.parentElement.cells[0].innerText;\n    let url = \"/v1/aspsps/\" + uuidCell;\n\n    fetch(url, {\n        method: 'DELETE',\n        headers: {\n            'Content-Type': 'application/json'\n        }\n    }).then((response) => {\n        if (response.status !== 204) {\n            throw Error(response.statusText);\n        }\n        purgeRow(e);\n        return response;\n    }).catch(function (error) {\n        console.log(error);\n    });\n}\n","function updateButton(e) {\n    fetch(\"/v1/aspsps/\", {\n        method: 'PUT',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: assembleRowData(e)\n    }).then((response) => {\n        if (!response.ok) {\n            throw Error(response.statusText);\n        }\n        return response;\n    }).then(response => {\n        if (response.ok) {\n            toggleButtons(e);\n        }\n    }).catch(function (error) {\n        console.log(error);\n    });;\n}\n","function saveButton(e) {\n    let row = e.parentElement.parentElement;\n\n    fetch(\"/v1/aspsps/\", {\n        method: 'POST',\n        headers: {\n            'Content-Type': 'application/json'\n        },\n        body: assembleRowData(e)\n    }).then((response) => {\n        if (response.status !== 201) {\n            throw Error(response.statusText);\n        }\n        row.removeAttribute(\"class\");\n        return response;\n    }).then(response => {\n        if (response.status === 201) {\n            toggleButtons(e);\n        }\n    }).catch(function (error) {\n        console.log(error);\n    });\n}\n","function purgeRow(e) {\n    let tableRow = e.parentElement.parentElement;\n\n    tableRow.remove();\n}\n","function buildRow(data) {\n    let editId = \"edit-\";\n    let updateId = \"update-\";\n    let deleteId = \"delete-\";\n\n    let clone = HIDDEN_ROW.cloneNode(true);\n    clone.removeAttribute(\"class\");\n\n    clone.cells[0].textContent = data.id;\n    clone.cells[1].textContent = data.name;\n    clone.cells[2].textContent = data.bic;\n    clone.cells[3].textContent = data.url;\n    clone.cells[4].textContent = data.adapterId;\n    clone.cells[5].textContent = data.bankCode;\n    clone.cells[6].textContent = data.idpUrl;\n    approacheParser(data.approach, clone.cells[7]);\n\n    clone.lastElementChild.childNodes.forEach(e => {\n        if (e.className) {\n            if (e.className.indexOf(\"edit\") > -1) {\n                let helper = e.parentNode.childNodes[7];\n\n                e.addEventListener(\"click\", () => { editButton(e) })\n                e.setAttribute(\"id\", editId + COUNTER);\n\n                helper.setAttribute(\"data-mdl-for\", editId + COUNTER);\n            }\n\n            if (e.className.indexOf(\"update\") > -1) {\n                let helper = e.parentNode.childNodes[9];\n\n                e.addEventListener(\"click\", () => { greenButton(e) })\n                e.setAttribute(\"id\", updateId + COUNTER);\n\n                helper.setAttribute(\"data-mdl-for\", updateId + COUNTER);\n            }\n\n            if (e.className.indexOf(\"delete\") > -1) {\n                let helper = e.parentNode.childNodes[11];\n\n                e.addEventListener(\"click\", () => { redButton(e) })\n                e.setAttribute(\"id\", deleteId + COUNTER);\n\n                helper.setAttribute(\"data-mdl-for\", deleteId + COUNTER);\n            }\n        }\n    });\n    document.querySelector(\"table>tbody\").appendChild(clone)\n\n    COUNTER++;\n\n    function approacheParser(data, cell) {\n        if(!data) {\n            return;\n        }\n\n        let inputs = cell.querySelectorAll(\"input\");\n\n        data.forEach(element => {\n            switch (element) {\n                case \"EMBEDDED\":\n                    inputs[0].checked = true;\n                    break;\n                case \"REDIRECT\":\n                    inputs[1].checked = true;\n                    break;\n                case \"DECOUPLED\":\n                    inputs[2].checked = true;\n                    break;\n                case \"OAUTH\":\n                    inputs[3].checked = true;\n                    break;\n            }\n        })\n    }\n}\n","function showTable() {\n    let table = HIDDEN_ROW.parentElement.parentElement.parentElement;\n    let message = document.querySelector(\".welcome-message\");\n\n    table.hidden = false;\n    message.hidden = true;\n}\n","function clearTable() {\n    let body = document.querySelectorAll(\"tbody>tr\");\n\n    if (body.length > 1) {\n        body.forEach(e => { if (!e.className) { e.remove(); } })\n    }\n}\n","function assembleRowData(e) {\n    let row = e.parentNode.parentNode;\n\n    let id = \"{\\\"id\\\": \\\"\" + row.cells[0].textContent + \"\\\",\\n\";\n    let bankName = \"\\\"name\\\": \\\"\" + row.cells[1].textContent + \"\\\",\\n\";\n    let bic = \"\\\"bic\\\": \\\"\" + row.cells[2].textContent + \"\\\",\\n\";\n    let url = \"\\\"url\\\": \\\"\" + row.cells[3].textContent + \"\\\",\\n\";\n    let adapterId = \"\\\"adapterId\\\": \\\"\" + row.cells[4].textContent + \"\\\",\\n\";\n    let bankCode = \"\\\"bankCode\\\": \\\"\" + row.cells[5].textContent + \"\\\",\\n\";\n    let idpUrl = \"\\\"idpUrl\\\": \\\"\" + row.cells[6].textContent + \"\\\",\\n\";\n    let approache = \"\\\"aspspScaApproaches\\\": \\\"\" + approacheParser(row.cells[7]) + \"\\\"}\";\n\n    return id + bankName + bic + url + adapterId + bankCode + idpUrl + approache;\n\n    function approacheParser(data) {\n        let inputs = data.querySelectorAll(\"input\");\n        let resultString = \"\";\n\n        inputs.forEach((element) => {\n            if(element.checked){\n                resultString += element.name + \";\";\n            }\n        })\n\n        return resultString.slice(0, -1);\n    }\n}\n","function upload() {\n    let file = FILE_UPLOAD_FIELD.files[0];\n    let data = new FormData();\n\n    data.append(\"file\", file);\n\n    fetch(\"/v1/aspsps/import\", {\n        method: 'POST',\n        body: data\n    })\n        .then(response => {\n            if (!response.ok) {\n                uploadFailed();\n                throw Error(response.statusText);\n            }\n            response;\n            success();\n        })\n        .catch(error => console.log(error))\n}\n","function onEnterPress(event) {\n    if (event.keyCode === 13) {\n        search();\n    }\n}\n","function clearContent() {\n    clearTable();\n\n    document.querySelectorAll(\".mdl-textfield__input\").forEach(element => {element.value = \"\"; element.parentElement.classList.remove(\"is-dirty\")});\n}\n","function uploadFailed() {\n    let failure = document.querySelector(\".upload\")\n\n    setTimeout(() => { failure.style.opacity = 1 }, 500);\n\n    setTimeout(() => { failure.style.opacity = 0 }, 8000);\n}\n\nfunction searchFailed() {\n    let failure = document.querySelector(\".failure.search\")\n\n    setTimeout(() => { failure.style.opacity = 1 }, 500);\n\n    setTimeout(() => { failure.style.opacity = 0 }, 8000);\n}\n","function success() {\n    let success = document.querySelector(\".success\")\n\n    setTimeout(() => { success.style.opacity = 1 }, 500);\n\n    setTimeout(() => { success.style.opacity = 0 }, 8000);\n}\n"]}